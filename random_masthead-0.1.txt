# random_masthead v0.1
# Returns a random masthead, given a category
# Dan Lowe
# http://tangledhelix.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjc6InZlcnNpb24iO3M6MzoiMC4xIjtzOjY6ImF1dGhvciI7czo4OiJEYW4gTG93
ZSI7czoxMDoiYXV0aG9yX3VyaSI7czoyNDoiaHR0cDovL3RhbmdsZWRoZWxpeC5jb20vIjtz
OjExOiJkZXNjcmlwdGlvbiI7czo0MzoiUmV0dXJucyBhIHJhbmRvbSBtYXN0aGVhZCwgZ2l2
ZW4gYSBjYXRlZ29yeSI7czo0OiJ0eXBlIjtpOjA7czo0OiJuYW1lIjtzOjE1OiJyYW5kb21f
bWFzdGhlYWQiO3M6NDoiaGVscCI7czo1NzQ6Igo8cD48c3Ryb25nPnR4cDpyYW5kb21fbWFz
dGhlYWQ8L3N0cm9uZz48L3A+Cgo8cD5UaGlzIHBsdWdpbiByZXR1cm5zIGEgcmFuZG9tIG1h
c3RoZWFkIGltYWdlIGZyb20gYSBnaXZlbiBpbWFnZSBjYXRlZ29yeS4KVXBsb2FkIHlvdXIg
bWFzdGhlYWRzLCBwdXQgdGhlbSBhbGwgaW50byBzb21lIGltYWdlIGNhdGVnb3J5LCB0aGVu
CnB1dCB0aGlzIGluIHlvdXIgcGFnZSB0ZW1wbGF0ZSBvciBmb3JtIChzdWJzdGl0dXRpbmcg
eW91ciBvd24gY2F0ZWdvcnkKbmFtZSk6PC9wPgoKPHA+PGNvZGU+Jmx0O3R4cDpyYW5kb21f
bWFzdGhlYWQgY2F0ZWdvcnk9JnF1b3Q7c2l0ZS1tYXN0aGVhZCZxdW90OyZuYnNwOy8mZ3Q7
PC9jb2RlPjwvcD4KCjxwPkFsc28gYWNjZXB0cyB0aGUgPGNvZGU+bGlua3RleHQ9JnF1b3Q7
bGFiZWwgdGV4dCZxdW90OzwvY29kZT4gYXR0cmlidXRlLAp3aGljaCB3aWxsIGJlIHVzZWQg
YXMgdGhlIEFMVCBhbmQgVElUTEUgdGFnIGZvciB0aGUgbWFzdGhlYWQuPC9wPgoKPHA+Q2F2
ZWF0OiBwZXJoYXBzIHNwZWNpYWxpemVkIGZvciBtZSBhbmQgbm90IHVzZWZ1bCB0byBvdGhl
cnMuPC9wPgoiO3M6NDoiY29kZSI7czoxMDIzOiIKICAgIGZ1bmN0aW9uIHJhbmRvbV9tYXN0
aGVhZCgkYXR0cykKICAgIHsKICAgICAgICBnbG9iYWwgJGltZ19kaXI7CiAgICAgICAgZXh0
cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAgICAgJ2NhdGVnb3J5JyA9PiAnJywKICAgICAg
ICAgICAgJ2xpbmt0ZXh0JyA9PiAnR28gdG8gbWFpbiBwYWdlJywKICAgICAgICApLCRhdHRz
KSk7CgogICAgICAgICRycyA9IHNhZmVfcm93c19zdGFydCgKICAgICAgICAgICAgIioiLCAi
dHhwX2ltYWdlIiwgImNhdGVnb3J5PSciLmRvU2xhc2goJGNhdGVnb3J5KS4iJyIKICAgICAg
ICApOwoKICAgICAgICBpZiAoJHJzKSB7CiAgICAgICAgICAgIHdoaWxlICgkYSA9IG5leHRS
b3coJHJzKSkgewogICAgICAgICAgICAgICAgZXh0cmFjdCgkYSk7CiAgICAgICAgICAgICAg
ICAkb3V0W10gPSBhcnJheSggaWQgPT4gJGlkLCBoID0+ICRoLCB3ID0+ICR3LCBleHQgPT4g
JGV4dCApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpc19hcnJheSgkb3V0KSkg
ewogICAgICAgICAgICAgICAgc3JhbmQoKGRvdWJsZSltaWNyb3RpbWUoKSoxMDAwMDAwKTsK
ICAgICAgICAgICAgICAgICRyYW5kdmFsID0gcmFuZCgwLChzaXplb2YoJG91dCktMSkpOwog
ICAgICAgICAgICAgICAgJGltYWdlID0gJG91dFskcmFuZHZhbF07CiAgICAgICAgICAgICAg
ICByZXR1cm4gJzxhIGhyZWY9IicgLiBodSAuICciIHRpdGxlPSInLiRsaW5rdGV4dC4nIj4n
CiAgICAgICAgICAgICAgICAgICAgIC4gJzxpbWcgc3JjPSInIC4gaHUgLiAkaW1nX2RpciAu
ICcvJwogICAgICAgICAgICAgICAgICAgICAuICRpbWFnZVsnaWQnXS4kaW1hZ2VbJ2V4dCdd
CiAgICAgICAgICAgICAgICAgICAgIC4gJyIgd2lkdGg9IicuJGltYWdlWyd3J10uJyIgaGVp
Z2h0PSInLiRpbWFnZVsnaCddCiAgICAgICAgICAgICAgICAgICAgIC4gJyIgYWx0PSInLiRs
aW5rdGV4dC4nIiBib3JkZXI9IjAiIC8+PC9hPic7CiAgICAgICAgICAgIH0KICAgICAgICB9
CiAgICAgICAgcmV0dXJuICcnOwogICAgfQoiO3M6MzoibWQ1IjtzOjMyOiI1OWE4N2RlMWY3
ZTYwYTFiZDY5NDNmMjFlN2I0NTFmNSI7fQ==
