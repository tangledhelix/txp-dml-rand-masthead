# dml_rand_masthead v0.4
# Returns a random masthead, given a category
# Dan Lowe
# http://tangledhelix.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjc6InZlcnNpb24iO3M6MzoiMC40IjtzOjY6ImF1dGhvciI7czo4OiJEYW4gTG93
ZSI7czoxMDoiYXV0aG9yX3VyaSI7czoyNDoiaHR0cDovL3RhbmdsZWRoZWxpeC5jb20vIjtz
OjExOiJkZXNjcmlwdGlvbiI7czo0MzoiUmV0dXJucyBhIHJhbmRvbSBtYXN0aGVhZCwgZ2l2
ZW4gYSBjYXRlZ29yeSI7czo0OiJ0eXBlIjtpOjA7czo0OiJuYW1lIjtzOjE3OiJkbWxfcmFu
ZF9tYXN0aGVhZCI7czo0OiJoZWxwIjtzOjUwOToiCjxwPjxzdHJvbmc+dHhwOmRtbF9yYW5k
X21hc3RoZWFkPC9zdHJvbmc+PC9wPgoKPHA+VGhpcyBwbHVnaW4gcmV0dXJucyBhIHJhbmRv
bSBtYXN0aGVhZCBpbWFnZSBmcm9tIGEgZ2l2ZW4gaW1hZ2UgY2F0ZWdvcnkuClVwbG9hZCB5
b3VyIG1hc3RoZWFkcywgcHV0IHRoZW0gYWxsIGludG8gc29tZSBpbWFnZSBjYXRlZ29yeSwg
dGhlbgpwdXQgdGhpcyBpbiB5b3VyIHBhZ2UgdGVtcGxhdGUgb3IgZm9ybSAoc3Vic3RpdHV0
aW5nIHlvdXIgb3duIGNhdGVnb3J5Cm5hbWUpOjwvcD4KCjxwPjxjb2RlPiZsdDt0eHA6ZG1s
X3JhbmRfbWFzdGhlYWQgY2F0ZWdvcnk9JnF1b3Q7c2l0ZS1tYXN0aGVhZCZxdW90OyZuYnNw
Oy8mZ3Q7PC9jb2RlPjwvcD4KCjxwPkFsc28gYWNjZXB0cyB0aGUgPGNvZGU+bGlua3RleHQ9
JnF1b3Q7bGFiZWwgdGV4dCZxdW90OzwvY29kZT4gYXR0cmlidXRlLAp3aGljaCB3aWxsIGJl
IHVzZWQgYXMgdGhlIEFMVCBhbmQgVElUTEUgdGFnIGZvciB0aGUgbWFzdGhlYWQuPC9wPgoi
O3M6NDoiY29kZSI7czo5NzM6IgovLyB7e3sgZG1sX3JhbmRfbWFzdGhlYWQoKQoKZnVuY3Rp
b24gZG1sX3JhbmRfbWFzdGhlYWQoJGF0dHMpCnsKICAgIGdsb2JhbCAkaW1nX2RpcjsKCiAg
ICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICdjYXRlZ29yeScgPT4gJycsCiAgICAg
ICAgJ2xpbmt0ZXh0JyA9PiAnR28gdG8gbWFpbiBwYWdlJywKICAgICksJGF0dHMpKTsKCiAg
ICAkcnMgPSBzYWZlX3Jvd3Nfc3RhcnQoCiAgICAgICAgJyonLCAndHhwX2ltYWdlJywgImNh
dGVnb3J5PSciLmRvU2xhc2goJGNhdGVnb3J5KS4iJyIKICAgICk7CgogICAgaWYgKCRycykK
ICAgIHsKICAgICAgICB3aGlsZSAoJGEgPSBuZXh0Um93KCRycykpCiAgICAgICAgewogICAg
ICAgICAgICBleHRyYWN0KCRhKTsKICAgICAgICAgICAgJG91dFtdID0gYXJyYXkoIGlkID0+
ICRpZCwgaCA9PiAkaCwgdyA9PiAkdywgZXh0ID0+ICRleHQgKTsKICAgICAgICB9CgogICAg
ICAgIGlmIChpc19hcnJheSgkb3V0KSkKICAgICAgICB7CiAgICAgICAgICAgIHNyYW5kKChk
b3VibGUpbWljcm90aW1lKCkqMTAwMDAwMCk7CiAgICAgICAgICAgICRyYW5kdmFsID0gcmFu
ZCgwLChzaXplb2YoJG91dCktMSkpOwogICAgICAgICAgICAkaW1hZ2UgPSAkb3V0WyRyYW5k
dmFsXTsKCiAgICAgICAgICAgIHJldHVybiAnPGEgaHJlZj0iJyAuIGh1IC4gJyIgdGl0bGU9
IicuJGxpbmt0ZXh0LiciPicKICAgICAgICAgICAgICAgICAuICc8aW1nIHNyYz0iJyAuIGh1
IC4gJGltZ19kaXIgLiAnLycKICAgICAgICAgICAgICAgICAuICRpbWFnZVsnaWQnXS4kaW1h
Z2VbJ2V4dCddCiAgICAgICAgICAgICAgICAgLiAnIiB3aWR0aD0iJy4kaW1hZ2VbJ3cnXS4n
IiBoZWlnaHQ9IicuJGltYWdlWydoJ10KICAgICAgICAgICAgICAgICAuICciIGFsdD0iJy4k
bGlua3RleHQuJyIgYm9yZGVyPSIwIiAvPjwvYT4nOwogICAgICAgIH0KICAgIH0KCiAgICBy
ZXR1cm4gJyc7Cn0KCi8vIH19fQoiO3M6MzoibWQ1IjtzOjMyOiI5ZDhiYmIyNGU2MTZjMzNi
YjQ2ZGNkMTE1MGI4YjZmMiI7fQ==
